<!--+ Warning: Content inside HTML comment blocks was generated by mdat and may be overwritten. +-->

# itson

<!-- badges -->

[![NPM Package itson](https://img.shields.io/npm/v/itson.svg)](https://npmjs.com/package/itson)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

<!-- /badges -->

<!-- short-description -->

**A CLI tool for configuration-driven application management for long-running interactive installations.**

<!-- /short-description -->

## Overview

- AMPM
- pm2

Native implementations are used wherever possible (e.g. launchd for process management, the system keychain for credential storage.)

## Getting started

### Dependencies

Itson is architected with future cross-platform support in mind, but currently only provides implementations for macOS.

Itson requires Node 22.12.0+.

### Installation

```sh
npm install --global itson
```

## Usage

Invoke `itson` to update the system to reflect your configuration, check for and install any application updates, and then immediately launch any specified applications.

This command runs automatically at system startup when `runOnStartup: true` in your configuration.

### Configuration

Create an `itson.config.js` file in your home directory.

```js
export default {
  applications: [
    {
      command: '/Applications/AllWork.app/Contents/MacOS/AllWork',
      name: 'AllWork',
      update: {
        artifactPattern: /^AllWork.+\.zip$/,
        destination: '/Applications/AllWork.app',
        owner: 'kitschpatrol',
        repo: 'allwork',
        type: 'github',
      },
    },
    {
      command: 'interpose',
      name: 'Interpose',
    },
  ],
  runOnStartup: true,
}
```

An optional `update` strategy may be specified.

Currently, only updates from GitHub releases with attached binary artifacts are supported.

Private GitHub repositories are supported via personal access tokens bearing at least the `contents:read` and `metadata:read` permissions.

### Commands

<!-- cli-help {depth: 1} -->

#### Command: `itson`

Run an itson command. Defaults to `launch` if a command is not provided.

If no command is provided, `itson launch` is run by default.

Usage:

```txt
itson [command]
```

| Command    | Description                                                                                                               |
| ---------- | ------------------------------------------------------------------------------------------------------------------------- |
| `launch`   | Update, register, and start all managed applications. Applications will auto-restart if they crash. _(Default command.)_  |
| `start`    | Start all managed applications. Applications will auto-restart if they crash.                                             |
| `stop`     | Stop all managed applications.                                                                                            |
| `update`   | Update all managed applications to the latest available versions.                                                         |
| `register` | Register itson with the system according to the config file. Optionally run this after changing state in the config file. |
| `reset`    | Clear any credentials stored in the system keychain, and remove any registered services.                                  |

| Option              | Description              | Type      |
| ------------------- | ------------------------ | --------- |
| `--verbose`         | Run with verbose logging | `boolean` |
| `--help`<br>`-h`    | Show help                | `boolean` |
| `--version`<br>`-v` | Show version number      | `boolean` |

<!-- /cli-help -->

## Maintainers

[@kitschpatrol](https://github.com/kitschpatrol)

<!-- contributing -->

## Contributing

[Issues](https://github.com/kitschpatrol/itson/issues) and pull requests are welcome.

<!-- /contributing -->

<!-- license -->

## License

[MIT](license.txt) Â© Eric Mika

<!-- /license -->

---

## Dev Notes

Should probably rewrite this in Go.

### Keychain

- [keytar-forked](https://github.com/shiftkey/node-keytar)
- [node-keytar](https://github.com/makeproaudio/node-keytar)

### Launchd

- [svcinstall](https://github.com/bryanmacfarlane/svcinstall) (cross-platform)
- [npm-launchctl-helper](https://github.com/alex-kostirin/npm-launchctl-helper)
- [launchd.info](https://launchd.info/)
- Agents: `~/Users/mika~/Library/LaunchAgents/`
- Logs: `/tmp/`
